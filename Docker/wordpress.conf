<DirectoryMatch "/uploads/">
	Options -Indexes
	Options -ExecCGI
	AddHandler text/plain .php .php3 .php4 .phtml .pl .py .jsp .asp .htm .shtml .sh .cgi .js .php5 .exe .com
</DirectoryMatch>
<DirectoryMatch "/plugins/">
	Options -Indexes
</DirectoryMatch>
<FilesMatch ^wp-config.php$ >
	Order allow,deny
	Deny from all
</FilesMatch>
<FilesMatch ^readme.html$ >
	Order allow,deny
	Deny from all
</FilesMatch>
<FilesMatch ^install.php$ >
	AuthType Basic
        AuthName "WP Upgrade Security Layer"
        AuthUserFile /etc/apache2/wpupgrade.passwd
        require  valid-user
</FilesMatch>
<FilesMatch ^upgrade.php$ >
	AuthType Basic
        AuthName "WP Upgrade Security Layer"
        AuthUserFile /etc/apache2/wpupgrade.passwd
        require  valid-user
</FilesMatch>
#<FilesMatch ^swfupload.swf$ >
#	Order allow,deny
#        Deny from all
#</FilesMatch>
#<FilesMatch ^install.php$ >
#	Order deny,allow
#	Deny from all
#	Allow from localhost
#</FilesMatch>

#<DirectoryMatch "/wp-admin/includes/" >
#	Order deny,allow
#	Deny from all
#</DirectoryMatch>
<DirectoryMatch "/wp-includes/" >
#	Order deny,allow
#	Deny from all
	Options -Indexes
</DirectoryMatch>
#<DirectoryMatch "/wp-includes/js/tinymce/langs/" >
#	Options -Indexes
#        Options -ExecCGI
#        AddHandler cgi-script .php .php3 .php4 .phtml .pl .py .jsp .asp .htm .shtml .sh .cgi .js .php5 .exe .com
#</DirectoryMatch>
#<DirectoryMatch "/wp-includes/theme-compat/" >
#	Order deny,allow
#	Deny from all
#</DirectoryMatch>
<IfModule mod_headers.c>
	Header unset X-Powered-By
	Header unset Server
</IfModule>

<DirectoryMatch "/wp-includes/" >
	RewriteEngine On
	RewriteCond %{QUERY_STRING} buttonImageURL [OR]
	RewriteCond %{QUERY_STRING} ButtonText [OR]
	RewriteCond %{QUERY_STRING} movieName
	RewriteRule .* index.php [F]
</DirectoryMatch>
<FilesMatch ^xmlrpc.php$ >
	Order allow,deny
	Deny from all
</FilesMatch>
<FilesMatch ^wpad.dat$ >
	Order allow,deny
	Deny from all
</FilesMatch>
<FilesMatch ^wp-db.php$ >
	php_value max_execution_time 3000
	php_value max_input_time 3000
	php_value memory_limit 1024M
</FilesMatch>
<FilesMatch ^export.php$ >
	php_value max_execution_time 3000
	php_value max_input_time 3000
	php_value memory_limit 1024M
</FilesMatch>
<FilesMatch ^formatting.php$ >
	php_value max_execution_time 3000
	php_value max_input_time 3000
</FilesMatch>
<FilesMatch ^kses.php$ >
	php_value max_execution_time 3000
	php_value max_input_time 3000
</FilesMatch>
<FilesMatch ^meta.php$ >
	php_value max_execution_time 3000
	php_value max_input_time 3000
	php_value memory_limit 512M
</FilesMatch>
<FilesMatch ^wp-includes/Requests/Transport/cURL.php$ >
	php_value max_execution_time 3000
	php_value max_input_time 3000
	php_value memory_limit 1024M
</FilesMatch>
<LocationMatch "^/wp-admin/admin.php">
  <If "%{QUERY_STRING} =~ /.*import=.*/" >
	php_value max_execution_time 3000
        php_value max_input_time 3000
        php_value memory_limit 1024M	
  </If>
</LocationMatch>
<IfModule mod_security2.c>
SecAction phase:1,nolog,pass,initcol:ip=%{REMOTE_ADDR},initcol:user=%{REMOTE_ADDR},id:5000134
<Locationmatch "/wp-login.php">
# Setup brute force detection.
# React if block flag has been set.
SecRule user:bf_block "@gt 0" "deny,status:401,log,id:5000135,msg:'ip address blocked for 5 minutes, more than 10 login attempts in 3 minutes.'"
# Setup Tracking. On a successful login, a 302 redirect is performed, a 200 indicates login failed.
SecRule RESPONSE_STATUS "^302" "phase:5,t:none,nolog,pass,setvar:ip.bf_counter=0,id:5000136"
SecRule RESPONSE_STATUS "^200" "phase:5,chain,t:none,nolog,pass,setvar:ip.bf_counter=+1,deprecatevar:ip.bf_counter=1/180,id:5000137"
SecRule ip:bf_counter "@gt 5" "t:none,setvar:user.bf_block=1,expirevar:user.bf_block=300,setvar:ip.bf_counter=0"
</locationmatch>
SecUploadDir /tmp
SecUploadKeepFiles Off
</IfModule>
#<FilesMatch "load-scripts\.php|load-styles\.php">
#  Order allow,deny
#  Deny from all
#</FilesMatch>

